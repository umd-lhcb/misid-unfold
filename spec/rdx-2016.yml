# this YAML is used by:
# - pidcalib2 wrapper (P)
# - tagged histogram builder (T)
# - ghost/uncategoried efficiency histogram builder (G)
# - unfolding weights applyer (A)
# - unfolding efficiency calculator (U)
# - histogram merger (M)

# cuts for each tagged species, used by ALL
# NOTE: here we follow C++ boolean convention (&&, ||)
tags:
    pi: "mu_ProbNNpi > 0.1 && mu_PIDK < 0.0 && mu_PIDp < 0.0 && mu_PIDe < 2.0 && mu_ProbNNghost < 0.25"
    k: "mu_PIDK > 0.0 && mu_PIDp < 0.0 && (mu_PIDe - mu_PIDK) < -2.0 && mu_ProbNNghost < 0.25"
    p: "mu_PIDp > 2.0 && mu_PIDK < 0.0 && (mu_PIDe - mu_PIDp) < -2.0 && mu_ProbNNghost < 0.25"
    e: "mu_PIDe > 2.0 && (mu_PIDe - mu_PIDK) > -2.0 && (mu_PIDe - mu_PIDp) > -2.0 && mu_ProbNNghost < 0.25"
    g: "!pi && !k && !p && !e"  # ghost/uncategoried

# additional species used by (P)
tags_addon:
    mu: "IsMuon == 1.0 & DLLmu > 2.0 & MC15TuneV1_ProbNNghost < 0.5"
    global: "IsMuon == 0.0 & InMuonAcc == 1.0"


# used by (T), (G)
# NOTE: currently consistent w/ Zishuo's binning
binning:
    P: [3.e+3, 6.e+3, 10.e+3, 15.6e+3, 27.e+3, 60.e+3, 100.e+3]  # the scific notation has to be written like this for PyYAML
    ETA: [1.7, 3.6, 5.0]
    nTracks: [0, 200, 600]

# used by (T), (A), (P)
binning_alias:
    pidcalib:
        P: Brunel_P
        ETA: Brunel_ETA
        nTracks: nTracks_Brunel
    offline:
        P: mu_P
        ETA: [mu_P, mu_PZ]
        nTracks: nTracks


# used by (P)
particle_alias:
    pi: Pi
    k: K
    p: P
    e: e_B_Jpsi
    # mu: Mu_nopt  # Mu samples are not used as of now


# NOTE: we apply all global cuts except Mu PID and B mass window
#       here we follow Python boolean convention (&, |)
global_cuts:
    # all except 'offline' is used by (P); 'offline' is used by (T)
    kinematic: "P > 3000 & P < 100000"
    tags: "IsMuon == 0.0 & InMuonAcc == 1.0"
    offline: dx_m_ok


# specify additional source of histograms
# used by the efficiency histogram merger (M)
# this will generate a single efficiency histo root file
input_histos:
    true_to_tag: "../histos/rdx-22_03_30_03_13-true_to_tag-2016/*.root"
    extra:
        "../histos/rjpsi-22_03_14_03_17-demo-2016/rjpsi-demo.root":
            H2H_Ghost_TO_Pi: gTrueToPiTag
            H2H_Ghost_TO_K: gTrueToKTag
            H2H_Ghost_TO_P: gTrueToPTag
            H2H_Ghost_TO_e: gTrueToETag
            H2H_Ghost_TO_Ghost: gTrueToGTag
            H2H_Ghost_TO_Mu: gTrueToMuTag


# building tagged histograms, used by (T), (A) and (U)
# for (A) and (U), it's for figuuring out histogram names only
# the key names will be prepended to the histograms
# e.g. Dst: <path_to_histo> -> Dst__piTag, Dst__kTag, etc.
input_ntps:
    # each entry should be a key-list pair, where list provides path to ntuples, with tree names
    D0:
        - "../ntuples/0.9.6-2016_production/Dst_D0-mu_misid_study-step2/D0--22_03_23--mu_misid--data--2016--*.root:tree"
